{
  "name": "pl_extract_synapse_cetas",
  "properties": {
    "activities": [
      {
        "name": "Execute CETAS",
        "type": "Script",
        "dependsOn": [],
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30
        },
        "typeProperties": {
          "scripts": [
            {
              "type": "NonQuery",
              "text": {
                "value": "@pipeline().parameters.source_query",
                "type": "Expression"
              }
            }
          ]
        },
        "linkedService": {
          "name": "SynapseConnection",
          "properties": {
            "type": "AzureSqlDW",
            "typeProperties": {
              "connectionString": {
                "value": "@pipeline().parameters.source_connection_string",
                "type": "Expression"
              }
            }
          }
        },
        "datasetSettings": {
          "type": "AzureSqlDWTable",
          "name": "SynapseDataset",
          "externalReferences": {
            "connection": {
              "value": "@pipeline().parameters.source_connection_id",
              "type": "Expression"
            }
          },
          "typeProperties": {
            "database": {
              "value": "@pipeline().parameters.source_database",
              "type": "Expression"
            }
          }
        }
      }
    ],
    "parameters": {
      "source_query": {
        "type": "string"
      },
      "source_connection_id": {
        "type": "string"
      },
      "source_database": {
        "type": "string"
      }
    }
  }
}
