# Configuration table for synapse extract objects - Lakehouse version

# Define schema for the table
schema = StructType([
    StructField("synapse_connection_name", StringType(), False),
    StructField("source_schema_name", StringType(), False),
    StructField("source_table_name", StringType(), False),
    StructField("export_base_dir", StringType(), True),
    StructField("extract_mode", StringType(), False),
    StructField("single_date_filter", StringType(), True),
    StructField("date_range_filter", StringType(), True),
    StructField("custom_select_sql", StringType(), True),
    StructField("execution_group", IntegerType(), False),
    StructField("active_yn", StringType(), False),
    # Pipeline/datasource now inferred from varlib; keep nullable in config
    StructField("synapse_sync_fabric_pipeline_id", StringType(), True),
    StructField("synapse_datasource_name", StringType(), True),
    StructField("synapse_datasource_location", StringType(), True)
])

target_lakehouse.create_table(
    table_name="synapse_extract_objects",
    schema=schema,
    mode="overwrite",
    options={
        "parquet.vorder.default": "true",
        "overwriteSchema": "true"
    }
)
